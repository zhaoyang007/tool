```vue
<template>
  <div class="browsehis-content" :style="{height: contentHeight + 'px'}">
    <div class="float-head">
      <div class="content">
        <p v-for="(item, index) in headerList.length ? [headerList[headerList.length - 1]] : []" :key="index">
          {{item}}
        </p>
      </div>
      <div class="cover"></div>
    </div>
    <el-scrollbar style="height: 100%;" ref="scroll">
      <div v-for="(value, index) in lists" :key="index+'history'" class="lists" :ref="'history_'+ value.date">
        <h3>{{ value.date.replace(/-/g, '/') }}</h3>
        <ul>
          <li v-for="(item, ind) in value.content" :key="ind+'history-item'">
            <a target="_blank">
              {{ item.viewFileName + '.' + item.viewFileType }}
              <span>{{ item.time }}</span>
            </a>
          </li>
        </ul>
      </div>
    </el-scrollbar>
  </div>
</template>

<script>
import axios from 'axios'

export default {
  props: {
    // 列表高度
    contentHeight: {
      type: Number,
      default: 0
    }
  },
  data() {
    return {
      lists: [],
      scrollTop: 0,
      headerList: [],
      date: ''
    }
  },
  async created() {
    const res = await axios.post('/spacex/file/v1/userView/getUserViews')
    if (res.data.code === 200) {
      let lists = res.data.result
      if (lists && Object.values(lists).length) {
        for (const key in lists) {
          this.lists.push(
            {
              date: key.replace(/-/g, '/'),
              content: lists[key]
            }
          )
        }
        this.$nextTick(() => {
          this.lists = this.lists.map(item => {
            return {
              ...item,
              offsetTop: this.$refs['history_' + item.date][0].offsetTop
            }
          })
        })
      }
    }
    // let lists = {
    //   '2020-11-05': [
    //     {
    //       'id': 7,
    //       'viewUser': 'songjiaping',
    //       'viewFileId': 33701,
    //       'viewFileName': '擦擦',
    //       'viewDateTime': '2020-11-05 06:30:50',
    //       'date': '2020-11-05',
    //       'time': '14:30:50'
    //     }
    //   ]
    // }
  },
  methods: {
    scrolls(e) {
      let a = this.lists.slice().reverse().find((item, index) => e.target.scrollTop + 30 > item.offsetTop)
      // let a1 = this.lists.find((item, index) => e.target.scrollTop + (this.lists.length - index) * 32 > item.offsetTop)
      // console.log(a1.date, '[pppsf')
      // console.log(a.date)
      if (this.scrollTop < e.target.scrollTop) {
        this.date = ''
        if (!this.headerList.includes(a.date)) {
          this.headerList.push(a.date)
          // this.headerList = [a.date]
        }
        // this.$refs['history_'+ a.date][0].firstElementChild.style = `position: fixed;top: ${index * 20}px`
      } else {
        // console.log(a.date, this.date, '[[[[[[999')
        // console.log(e.target.scrollTop)
        if ((this.headerList.includes(a.date) && a.date !== this.date && this.date) || e.target.scrollTop <= 32) {
          this.headerList.splice(this.headerList.findIndex(item => this.date === item.date), 1)
          // this.headerList = []
        }
        this.date = a.date
      }
      this.scrollTop = e.target.scrollTop
      // a.dom.querySeletor('h3').style = `postition: absolute;top: ${index * 20}px`
    }
  },
  mounted() {
    this.$refs.scroll.wrap.addEventListener('scroll', this.scrolls)
  }
}
</script>

<style lang="less">
.browsehis-content {
  // height: 465px;
  margin-top: 37px;
  position: relative;
  .float-head {
    position: absolute;
    width: 100%;
    top: 0px;
    z-index: 100;
    .content {
      // position: absolute;
      width: 100%;
      height: 100%;
      // top: 0;
      // left: 0;
      z-index: 101;
      background: #F5F5F5;
      p {
        height: 34px;
        line-height: 34px;
        background: #F5F5F5;
        color: #000;
        padding-left: 12px;
        margin-bottom: 8px;
        box-shadow: 2px 6px 8px #ccc;
        box-sizing: border-box;
      }
    }
  }
  .el-scrollbar__wrap {
    padding-left: 4px;
    overflow-x: hidden;
  }
  .lists {
    &:first-child::before {
      content: '';
      display: block;
      position: absolute;
      top: 0;
      left: 0;
      width: 10px;
      height: 5px;
      background: #fff;
    }
    padding-left: 12.5px;
    padding-bottom: 12px;
    border-left: 1px solid #EAEAEA;
    &:last-child {
      padding-bottom: 0px;
    }
    h3 {
      font-family: PingFang SC;
      font-style: normal;
      font-weight: normal;
      font-size: 12px;
      line-height: 18px;
      color: #000000;
      margin-bottom: 12px;
      position: relative;
      &::before {
        content: '';
        display: block;
        position: absolute;
        top: 4px;
        left: -18px!important;
        left: 0px;
        width: 8px;
        height: 8px;
        background: #2D7DFF;
        border: 1px solid #F5F5F5;
        border-radius: 50%;
      }
    }
    li {
      &:last-child {
        margin-bottom: 0;
      }
      margin-bottom: 12px;
      background: #F5F5F5;
      a {
        display: block;
        height: 34px;
        line-height: 34px;
        text-decoration: none;
        font-family: PingFang SC;
        font-style: normal;
        font-weight: normal;
        font-size: 12px;
        color: #000000;
        position: relative;
        padding-left: 12px;
        span {
          position: absolute;
          top: 0px;
          right: 12px;
        }
      }
    }
  }
}
</style>
```

