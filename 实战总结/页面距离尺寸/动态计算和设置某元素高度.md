```vue
<template>
  <div :class="classNames" :ref="classNames">
    <div :class="classNames+ '_header'">
      <img src="./img/user.svg" alt="">
      <div :class="classNames+ '_header_con'">
        <h5>{{user.name}}</h5>
        <p>{{user.desc}}</p>
      </div>
    </div>
    <div :class="classNames+ '_content'">
      <tabs :data="tabsList" v-model="tabsActTit" type="bg" :class="classNames+ '_bg'" @changeTabs="changeTabs"></tabs>
      <tabs :data="tabsLists" v-model="tabsActTits" type="line" @changeTabs="changeChildTabs" v-if="tabsActTit!=='浏览历史'"></tabs>
      <div ref="list" :class="classNames + '_list_con'">
        <do-list v-if="!isBrowse" doc-type="list" @currChange="onCurrChange" :loading="loading" :list="list" :page="page" :content-height="listHeight" :class="classNames+'_list'" send-type="iframe" @sort="onSort" ref="history_list"></do-list>
        <browse-history :content-height="listHeight" v-else/>
      </div>
    </div>
  </div>
</template>
<script>
import DocList from '../platform/main/docList/index'
import BrowseHistory from './browseHistory.vue'
import tabs from './tabs'
import axios from 'axios'
import bus from '@/utils/bus'
export default {
  data() {
    return {
      classNames: 'history',
      tabsList: [
        {
          label: '我的收藏',
          value: 'preferenceTime'
        },
        {
          label: '我的发布',
          value: 'createTime'
        },
        {
          label: '我的下载',
          value: 'downTime'
        },
        {
          label: '浏览历史',
          value: '浏览历史'
        }
      ],
      tabsLists: [
        {
          label: '全部类别',
          value: '全部类别'
        },
        {
          label: '专题研究',
          value: '专题研究'
        },
        {
          label: '工作流文档',
          value: '工作流文档'
        },
        {
          label: '政策与规范',
          value: '政策与规范'
        },
        {
          label: '周月报',
          value: '周月报'
        },
        {
          label: '其他',
          value: '其他'
        }
      ],
      tabsActTit: 'preferenceTime',
      tabsActTits: '全部类别',
      list: {
        list: [],
        page: 1,
        isNodata: true
      },
      page: { // 分页参数
        total: 0,
        size: 10,
        page: 0,
        curr: 1
      },
      findType: 1,
      userNameM: localStorage.getItem('loginName'),
      renderData: [],
      loading: false,
      listHeight: 0,
      user: {},
      sort: {}
    }
  },
  computed: {
    isBrowse() {
      return this.tabsActTit === '浏览历史'
    }
  },
  created() {
    this.tabsList.forEach(item => {
      this.sort[item.value] = {
        orderBy: item.value,
        orderByTpe: '0'
      }
    })
    console.log(this.sort)
    this.getMyCollections()
    this.getPersonalCenterHeader()
    this.$nextTick(() => {
      this.$refs.history_list.$refs.pageable.orderTitle = '收藏时间'
    })
  },
  mounted() {
    this.$nextTick(() => {
      setTimeout(() => {
        this.listHeight = this.$refs[this.classNames].clientHeight - this.$refs.list.getBoundingClientRect().top - 52
      }, 200)
    })
  },
  methods: {
    onCurrChange(num, data) {
      console.log(data, 'pppp')
      this.page.curr = num
      this.renderData = data
      this.getMyCollections()
    },
    async getMyCollections(flag = true) {
      if (this.tabsActTit === '浏览历史') {
        return
      }
      this.loading = true
      if (this.tabsActTit === 'preferenceTime') {
        this.findType = 1
      } else {
        this.findType = 2
      }
      let param = this.tabsActTit !== 'downTime' ? {
        'userName': this.userNameM,
        'pageSize': 20,
        'page': this.page.curr,
        'findType': this.findType,
        fileCategory: this.tabsActTits,
        ...this.sort[this.tabsActTit]
      } : {
        fileCategory: this.tabsActTits,
        page: this.page.curr,
        pageSize: 20,
        ...this.sort[this.tabsActTit]
      }
      this.list = {
        list: flag ? this.renderData : [],
        page: param.page,
        isNodata: true
      }
      let url = this.tabsActTit !== 'downTime' ? '/spacex/services/v1/collect/getOwnFile' : '/spacex/file/v1/userDownload/findUserDownLoadFiles'
      let res = await this.postData(url, param)
      this.loading = false
      this.list = {
        list: res.list,
        page: param.page,
        isNodata: false
      }
      this.page = Object.assign(this.page, { total: res.counts, page: res.pages })
    },
    postData(url, params) {
      return new Promise((resolve, reject) => {
        axios
          .post(url, params)
          .then(response => {
            resolve(response.data.result)
          })
          .catch(error => {
            reject(error)
          })
      })
    },
    changeTabs(value) {
      if (value.label === '浏览历史') {
        return
      }
      let orderTitle = value.label.slice(2, 4) + '时间'
      try {
        this.$nextTick(() => {
          this.$refs.history_list.$refs.pageable.orderTitle = orderTitle
          this.$refs.history_list.$refs.pageable.sortOrder = this.sort[this.tabsActTit].orderByTpe == 1 ? 'asce' : 'desc'
        })
      } catch (error) {
        throw Error(error)
      }
      bus.$emit('reload')
      this.list = [
        {
          list: [],
          page: 1,
          isNodata: true
        }
      ]
      this.page.curr = 1
      this.getMyCollections(false)
    },
    changeChildTabs(value) {
      bus.$emit('reload')
      this.list = [
        {
          list: [],
          page: 1,
          isNodata: true
        }
      ]
      this.page.curr = 1
      this.getMyCollections(false)
    },
    async getPersonalCenterHeader() {
      let result = await this.postData('/services/v1/personalCenter/getPersonalCenterHeader')
      this.user = {
        name: result.loginName,
        desc: result.deptInfo
      }
    },
    onSort(val) {
      this.sort[this.tabsActTit].orderByTpe = val === 'asce' ? 1 : 0
      bus.$emit('reload')
      this.list = [
        {
          list: [],
          page: 1,
          isNodata: true
        }
      ]
      this.page.curr = 1
      this.getMyCollections(false)
    }
  },
  watch: {
    // 'page.curr'(news) {
    //   this.getMyCollections()
    // }
  },
  components: {
    'do-list': DocList,
    tabs,
    BrowseHistory
  }
}
</script>
<style lang="less">
  @classNames: history;
  .@{classNames}_list_con {
    background: #fff;
    #pagination {
      background: #fff!important;
      padding: 12px 0!important;
      #spa {
        color: #5B5B5B;
      }
      .block {
        .number {
          color: #5B5B5B;
          &.active {
            background: #EEF3FD;
            border-radius: 2px;
            color: #5587F0;
          }
        }
        .btn-prev, .btn-next {
          background: #fff!important;
          i {
            color: #323232
          }
        }
        .el-pagination__jump {
           color: #5B5B5B;
           .el-input__inner {
            background: #fff;
            border: 1px solid #D6D6D6;
            box-sizing: border-box;
            border-radius: 3px;
           }
        }
      }
    }
    .@{classNames}_list {
      .docItem{
        background: #f5f5f5;
        border: 1px solid transparent;
        &:hover {
          background: #FBFBFB!important;
          border: 1px solid rgba(45, 125, 255, 0.5)!important;
          box-sizing: border-box;
          .label {
            color: #5587F0!important;
          }
        }
        .title {
          h4 {
            color: #323232;
          }
          .suffix {
            color: #323232;
          }
        }
        .content{
          color: #6F6F6F;
        }
        .labelBox {
          .label {
            background: #EEF3FD;
            border: 1px solid #CCDBFA;
            box-sizing: border-box;
            border-radius: 4px;
            color: #5587F0;
            box-shadow: none;
          }
        }
        .footer {
          span {
            color: #999!important;
          }
          .info {
            color: #999!important;
          }
        }
      }
    }
  }
  .iframe-popover {
    &.el-popover  {
      border: 1px solid #EBEEF5;
      background: #fff;
      &.el-popper[x-placement^=bottom] .popper__arrow::after {
        border-bottom-color: #FFF;
        top: 0;
      }
    }
  }
</style>

<style lang="less" scoped>
  @classNames: history;
  .@{classNames} {
    width: 100%;
    height: 100%;
    min-width: 1088px;
    background: #FFFFFF;
    .@{classNames}_header {
      display: flex;
      padding: 32px 32px 20px 32px;
      box-sizing: border-box;
      background: #F5F5F5;
      .@{classNames}_header_con {
        padding-left: 12px;
        box-sizing: border-box;
        h5 {
          font-weight: 500;
          font-size: 16px;
          line-height: 24px;
          color: #323232;
          margin-bottom: 8px;
          margin-top: 8px;
        }
        p {
          font-size: 12px;
          line-height: 16px;
          color: #6F6F6F;
        }
      }
    }
    .@{classNames}_content {
      .@{classNames}_bg {
        margin-bottom: 7px;
        background: #F5F5F5;
      }
      .@{classNames}_list_con {
        padding: 0px 32px 0 32px;
        box-sizing: border-box;
      }
    }
  }
</style>

```

动态计算 ref=list 的高度 listHeight